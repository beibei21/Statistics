<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Wilcoxon Tests</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Math 325 Notebook</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Table of Contents</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Describing Data
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="GraphicalSummaries.html">Graphical Summaries</a>
    </li>
    <li>
      <a href="NumericalSummaries.html">Numerical Summaries</a>
    </li>
    <li>
      <a href="GeneralRCommands.html">General R Commands</a>
    </li>
    <li>
      <a href="RMarkdownHints.html">General R Markdown Hints</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Making Inference
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="MakingInference.html">Making Inference</a>
    </li>
    <li>
      <a href="tTests.html">t Tests</a>
    </li>
    <li>
      <a href="WilcoxonTests.html">Wilcoxon Tests</a>
    </li>
    <li>
      <a href="ANOVA.html">ANOVA</a>
    </li>
    <li>
      <a href="Kruskal.html">Kruskal-Wallis</a>
    </li>
    <li>
      <a href="LinearRegression.html">Linear Regression</a>
    </li>
    <li>
      <a href="LogisticRegression.html">Logistic Regression</a>
    </li>
    <li>
      <a href="ChiSquaredTests.html">Chi-Squared Tests</a>
    </li>
    <li>
      <a href="PermutationTests.html">Permutation Tests</a>
    </li>
  </ul>
</li>
<li>
  <a href="ClassNotes.html">Class Notes</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Critiquing Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Guide to Critiquing t Tests.html">T-Tests</a>
    </li>
    <li>
      <a href="Guide to Critiquing Wilcoxon Tests.html">Wilcoxon Tests</a>
    </li>
    <li>
      <a href="CritiquingANOVATests.html">ANOVA Tests</a>
    </li>
    <li>
      <a href="Guide to Critiquing Kruskal Tests.html">Guide to Critiquing Kruskal Tests</a>
    </li>
    <li>
      <a href="Critiquing Guide.html">Linear Regression</a>
    </li>
    <li>
      <a href="Critiquing Guide Logistic.html">Logistic Regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Analyses
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./Analyses/StudentHousingII.html">Student HousingII</a>
    </li>
    <li>
      <a href="./Analyses/Movies.html">Movies</a>
    </li>
    <li>
      <a href="./Analyses/IQTwins.html">IQ Twins</a>
    </li>
    <li>
      <a href="./Analyses/RecallingWords.html">Recalling Words- ANOVA</a>
    </li>
    <li>
      <a href="./Analyses/DayCare.html">DayCare- TWO-WAY ANOVA</a>
    </li>
    <li>
      <a href="./Analyses/ReadingComprehension.html">Reading Comp-Kruskal Wallis</a>
    </li>
    <li>
      <a href="./Analyses/MySimpleLinearRegression.html">SimpleLinearRegression</a>
    </li>
    <li>
      <a href="./Analyses/CarPrices.html">CarPrices-Multiple Linear Regression</a>
    </li>
    <li>
      <a href="./Analyses/Project1.html">Project1- Independent</a>
    </li>
    <li>
      <a href="./Analyses/MyLogisticRegression.html">Logistic Regression</a>
    </li>
    <li>
      <a href="./Analyses/Discrimination.html">Chi-Squared, Discrimination</a>
    </li>
    <li>
      <a href="./Analyses/Explosives.html">Permutations, Explosives</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Wilcoxon Tests</h1>

</div>


<script type="text/javascript">
 function showhide(id) {
    var e = document.getElementById(id);
    e.style.display = (e.style.display == 'block') ? 'none' : 'block';
 }
</script>
<hr />
<p>Wilcoxon tests allow for the testing of hypotheses about the value of the the <em>median</em> without assuming the test statistic follows any parametric distribution. They are often seen as nonparametric alternatives to the various t tests. However, they can also be used on ordinal data (data that is not quite quantitative, but is ordered) unlike t tests which require quantitative data.</p>
<hr />
<div id="wilcoxon-signed-rank-test" class="section level3 tabset tabset-fade tabset-pills">
<h3>Wilcoxon Signed-Rank Test</h3>
<div style="float:left;width:125px;" align="center">
<p><img src="Images/QuantY.png" width=35px;></p>
</div>
<p>For testing hypotheses about the value of the median of (1) one sample of quantitative data or (2) one set of differences from paired data.</p>
<div id="overview" class="section level4">
<h4>Overview</h4>
<div style="padding-left:125px;">
<p>The nonparametric equivalent of the paired-samples t test as well as the one-sample t test.</p>
<p>Best for smaller sample sizes where the distribution of the data is not normal. The t test is more appropriate when the data is normal or when the sample size is large.</p>
<p>While the test will work in most scenarios it suffers slightly when ties (repeated values) are present in the data. If <em>many</em> ties are present in the data, the test is not appropriate. If only a few ties are present, the test is still appropriate.</p>
<p><strong>Hypotheses</strong></p>
<p>Originally created to test hypotheses about the value of the median, but works as well for the mean when the distribution of the data is symmetrical.</p>
<div style="padding-left:15px;">
<p><span class="math inline">\(H_0: \text{median of differences} = 0\)</span></p>
<p><span class="math inline">\(H_a: \text{median of differences} \ \left\{\underset{&lt;}{\stackrel{&gt;}{\neq}}\right\} \ 0\)</span></p>
</div>
<p><strong>Examples</strong>: <a href="./Analyses/SleepPairedWilcoxon.html">sleep</a>, <a href="./Analyses/CornHeightsPairedWilcoxon.html">CornHeights</a></p>
</div>
<hr />
</div>
<div id="r-instructions" class="section level4">
<h4>R Instructions</h4>
<div style="padding-left:125px;">
<p><strong>Console</strong> Help Command: <code>?wilcox.test()</code></p>
<h5 id="paired-data">Paired Data</h5>
<p><code>wilcox.test(object1, object2, mu = YourNull, alternative = YourAlternative, paired = TRUE, conf.level = 0.95)</code></p>
<ul>
<li><code>object1</code> must be a “numeric” vector. One set of measurements from the pair.</li>
<li><code>object2</code> also a “numeric” vector. Other set of measurements from the pair.</li>
<li><code>YourNull</code> is the numeric value from your null hypothesis for the median of differences from the paired data. Usually zero.</li>
<li><code>YourAlternative</code> is one of the three options: <code>&quot;two.sided&quot;</code>, <code>&quot;greater&quot;</code>, <code>&quot;less&quot;</code> and should correspond to your alternative hypothesis.</li>
<li>The value for <code>conf.level = 0.95</code> can be changed to any desired confidence level, like 0.90 or 0.99. It should correspond to <span class="math inline">\(1-\alpha\)</span>.</li>
</ul>
<h5 id="one-sample">One Sample</h5>
<p><code>wilcox.test(object, mu = YourNull, alternative = YourAlternative, conf.level = 0.95)</code></p>
<ul>
<li><code>object</code> must be a “numeric” vector.</li>
<li><code>YourNull</code> is the numeric value from your null hypothesis for the median (even though it says “mu”).</li>
<li><code>YourAlternative</code> is one of the three options: <code>&quot;two.sided&quot;</code>, <code>&quot;greater&quot;</code>, <code>&quot;less&quot;</code> and should correspond to your alternative hypothesis.</li>
<li>The value for <code>conf.level = 0.95</code> can be changed to any desired confidence level, like 0.90 or 0.99. It should correspond to <span class="math inline">\(1-\alpha\)</span>.</li>
</ul>
</div>
<hr />
</div>
<div id="explanation" class="section level4">
<h4>Explanation</h4>
<div style="padding-left:125px;">
<p>In many cases it is of interest to perform a hypothesis test about the location of the center of a distribution of data. The Wilcoxon Signed Rank Test allows a nonparametric approach to doing this.</p>
<p>The Wilcoxon Signed-Rank Test covers two important scenarios.</p>
<ol style="list-style-type: decimal">
<li><strong>One sample</strong> of data from a population. (Not very common.)</li>
<li>The differences obtained from <strong>paired data</strong>. (Very common.)</li>
</ol>
<p>The Wilcoxon methods are most easily explained through examples, beginning with the paired data for which the method was originally created. Scroll down for the <a href="#one">One Sample Example</a> if that is what you are really interested in. However, it is still recommended that you read the paired data example first.</p>
<h5 id="paired-data-example">Paired Data Example</h5>
<div style="padding-left:15px;">
<div style="color:#a8a8a8;">
<p>Note: the data for this example comes from the original 1945 paper <a href="http://sci2s.ugr.es/keel/pdf/algorithm/articulo/wilcoxon1945.pdf">Individual Comparison by Ranking Methods</a> by Frank Wilcoxon.</p>
</div>
<h6 id="background">Background</h6>
<p>Height differences “between cross- and self- fertilized corn plants of the same pair” were collected. The experiment hypothesized that the center of the distribution of the height differences would be zero, with the alternative being that the center was not zero. The result of the data collection was 15 height differences:</p>
<div style="padding-left:15px;">
<p><strong>Differences</strong>: 14, 56, 60, 16, 6, 8, -48, 49, 24, 28, 29, 41, -67, 23, 75</p>
</div>
<h6 id="step-1">Step 1</h6>
<p>The first step of the Wilcoxon Signed Rank Test is to order the differences from smallest <em>magnitude</em> to largest <em>magnitude</em>. Negative signs are essentially ignored at this point and only magnitudes of the numbers matter.</p>
<div style="padding-left:15px;">
<p><strong>Sorted Differences</strong>: 6, 8, 14, 16, 23, 24, 28, 29, 41, -48, 49, 56, 60, -67, 75</p>
</div>
<h6 id="step-2">Step 2</h6>
<p>The next step is to rank the ordered values. Negative signs are attached to the ranks corresponding to negative numbers.</p>
<div style="padding-left:15px;">
<table>
<thead>
<tr class="header">
<th> </th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Differences</strong>:</td>
<td>6</td>
<td>8</td>
<td>14</td>
<td>16</td>
<td>23</td>
<td>24</td>
<td>28</td>
<td>29</td>
<td>41</td>
<td>-48</td>
<td>49</td>
<td>56</td>
<td>60</td>
<td>-67</td>
<td>75</td>
</tr>
<tr class="even">
<td><strong>Ranks</strong>:</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>-10</td>
<td>11</td>
<td>12</td>
<td>13</td>
<td>-14</td>
<td>15</td>
</tr>
</tbody>
</table>
</div>
<p>Note that the ranks will always be of the form <span class="math inline">\(1, 2, \ldots, n\)</span>. In this case, <span class="math inline">\(n=15\)</span>.</p>
<h6 id="step-3">Step 3</h6>
<p>The ranks are then put into two groups.</p>
<table>
<thead>
<tr class="header">
<th>Negative Ranks</th>
<th>Positive Ranks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>-10, -14</td>
<td>1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 15</td>
</tr>
</tbody>
</table>
<h6 id="step-4">Step 4</h6>
<p>One of the groups is summed, usually the group with the fewest observations. Only the absolute values of the ranks are summed.</p>
<div style="padding-left:15px;">
<p><strong>Sum of Negative Ranks</strong>: <span class="math inline">\(\left|-10\right| + \left|-14\right| = 24\)</span></p>
<p>The sum of the ranks becomes the <em>test statistic</em> of the Wilcoxon Test. The test statistic is sometimes called <span class="math inline">\(W\)</span> or <span class="math inline">\(V\)</span> or <span class="math inline">\(U\)</span>.</p>
</div>
<h6 id="step-5">Step 5</h6>
<p>The <span class="math inline">\(p\)</span>-value of the test is then obtained by computing the probability of the test statistic being as extreme or more extreme than the one obtained. This is done by first computing the probability of all possible values the test statistic could have obtained using mathematical counting techniques. This is a very tedious process that only a mathematician would enjoy pursuing. However, the end result is fairly easily understood. If you are interested, read the details.</p>
<div style="padding-left:30px; padding-right:15px;">
<p><a href="javascript:showhide('uniquename')"><strong>Details</strong></a></p>
<div id="uniquename" style="display:none;">
<p>When there are <span class="math inline">\(n=15\)</span> ranks, the possible sums of ranks range from 0 to 120 and hit every integer in between, i.e., <span class="math inline">\(1, 2, 3, \ldots, 120\)</span>. (Note, if summing the negative ranks these sums would technically all be negative.)</p>
<p>To verify that <span class="math inline">\(120\)</span> is the largest sum possible for <span class="math inline">\(n=15\)</span> ranks, note that:</p>
<ul>
<li><p><span class="math inline">\(1+15 = 16\)</span>,</p></li>
<li><p><span class="math inline">\(2 + 14 = 16\)</span>,</p></li>
<li><p><span class="math inline">\(3+13 = 16\)</span>,</p></li>
<li><p><span class="math inline">\(4+12=16\)</span>,</p></li>
<li><p><span class="math inline">\(5+11=16\)</span>,</p></li>
<li><p><span class="math inline">\(6+10=16\)</span>,</p></li>
<li><p><span class="math inline">\(7+9=16\)</span>,</p></li>
<li><p>and finally that <span class="math inline">\(8 = \frac{16}{2}\)</span>.</p></li>
</ul>
<p>Thus, there are 7 sums of 16 and one sum of <span class="math inline">\(\frac{16}{2}\)</span>. This could be said in a mathematically equivalent way by stating there are <span class="math inline">\(\frac{14}{2}\)</span> sums of 16 and one sum of <span class="math inline">\(\frac{16}{2}\)</span>. By multiplication this gives <span class="math display">\[
      \frac{14}{2}\cdot\frac{16}{1} + \frac{1}{1}\cdot\frac{16}{2} = \frac{14\cdot16 + 1\cdot16}{2} = \frac{15\cdot16}{2} = \frac{n(n+1)}{2} = 120
\]</span></p>
<p>The probability of each sum occurring is computed by counting all of the ways a certain sum can occur (combinations) and dividing by the total number of sums possible. (There are 32,768 total different groups of ranks possible when there are <span class="math inline">\(n=15\)</span> ranks.)</p>
<p>For example, a sum of 1 can happen only one way, only the rank of 1 is in the group. A sum of 2 can also only happen 1 way. The sum of 3 however, can happen two ways: we could have the ranks of 1 and 2 in the group, or just the rank of 3 in the group. A similar counting technique is then implemented for each possible sum. After all the calculations are performed, the distribution of possible sums looks like what is shown in the following plot, where the red bars show those sums that are as extreme or more extreme than a sum of <span class="math inline">\(24\)</span> (or its opposite of <span class="math inline">\(120-24=96\)</span>).</p>
</div>
</div>
<p><img src="WilcoxonTests_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Computing the probabilities of all possible sums creates a distribution of the test statistic (shown in the plot above). Note that the test statistic is obtained in Step 4 (above) by taking the sum of the ranks. Once the distribution of the test statistic is established, the <span class="math inline">\(p\)</span>-value of the test can be calculated as the combined probability of possible sums that are as extreme or more extreme than the one observed.</p>
<p>For this example, it turns out that the probability of getting a sum of (the absolute value of) negative ranks as extreme or more extreme than <span class="math inline">\(24\)</span> is <span class="math inline">\(p=0.04126\)</span> (the sum of the probabilities of the red bars in the plot above). Thus, at the <span class="math inline">\(\alpha=0.05\)</span> level we would reject the null hypothesis that the center of the distribution of differences is zero. We conclude that the center of the distribution is greater than zero because the sum of negative ranks is much smaller than we expected under the zero center hypothesis (the null). Thus, there is sufficient evidence to conclude that the centers of the distributions of “cross- and self-fertilized corn plants” heights are not equal. One is greater than the other. Notice how the following dot plot shows that the differences are in favor of the cross-fertilized plants (the first group in the subtraction) being taller. This is true even though two self-fertilized plants were much taller than their cross-fertilized counterpart (the two negative differences).</p>
<p><img src="WilcoxonTests_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<h6 id="comment">Comment</h6>
<p>If the distribution of differences is symmetric, then the hypotheses can be written as <span class="math display">\[
  H_0: \mu = 0
\]</span> <span class="math display">\[
  H_a: \mu \neq 0
\]</span></p>
<p>If the distribution is skewed, then the hypotheses technically refer to the median instead of the mean and should be written as</p>
<p><span class="math display">\[
      H_0: \text{median} = 0
\]</span> <span class="math display">\[
      H_a: \text{median} \neq 0
\]</span></p>
</div>
<h5 id="one">One Sample Example</h5>
<div style="padding-left:15px;">
<p>The idea behind the one sample Wilcoxon Signed Rank test is nearly identical to the paired data. The only change is that the median must be subtracted from all observed values to obtain the <em>differences</em>. Note that the mean is equal to the median when data is symmetric.</p>
<h6 id="background-1">Background</h6>
<p>Suppose we are interested in testing to see if the median hourly wage of BYU-Idaho students during their off-track employment is equal to the minimum wage in Idaho, $7.25 an hour as of January 1st, 2015. Five randomly sampled hourly wages from BYU-Idaho Math 221B students provides the following data.</p>
<div style="padding-left:15px;">
<p><strong>Wages</strong>: $6.00, $9.00, $8.10, $18.00, $10.45</p>
</div>
<p>The differences are then obtained by subtracting the hypothesized value for the median (or mean if the data is symmetric) from all observations.</p>
<div style="padding-left:15px;">
<p><strong>Differences</strong>: -1.25, 1.75, 0.85, 10.75, 3.20</p>
<div style="color:#a8a8a8;">
<p>Note: from this point down, the wording of this example is identical to the paired data example (above) with the numbers changed to match <span class="math inline">\(n=5\)</span>. It is useful to continue reading to reinforce the idea of the Wilcoxon Signed Rank Test, but no new knowledge will be presented.</p>
</div>
</div>
<h6 id="step-1-1">Step 1</h6>
<p>The first step of the Wilcoxon Signed Rank Test is to order the differences from smallest <em>magnitude</em> to largest <em>magnitude</em>. Negative signs are essentially ignored at this point and only magnitudes of the numbers matter.</p>
<div style="padding-left:15px;">
<p><strong>Sorted Differences</strong>: 0.85, -1.25, 1.75, 3.20, 10.75</p>
</div>
<h6 id="step-2-1">Step 2</h6>
<p>The next step is to rank the ordered values. Negative signs are attached to the ranks corresponding to negative numbers.</p>
<div style="padding-left:15px;">
<p><strong>Ranks</strong>: 1, -2, 3, 4, 5</p>
</div>
<p>Note that the ranks will always be of the form <span class="math inline">\(1, 2, \ldots, n\)</span>. In this case, <span class="math inline">\(n=5\)</span>.</p>
<h6 id="step-3-1">Step 3</h6>
<p>The ranks are then put into two groups.</p>
<table>
<thead>
<tr class="header">
<th>Negative Ranks</th>
<th>Positive Ranks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>-2</td>
<td>1, 3, 4, 5</td>
</tr>
</tbody>
</table>
<h6 id="step-4-1">Step 4</h6>
<p>One of the groups is summed, usually the group with the fewest observations.</p>
<div style="padding-left:15px;">
<p><strong>Sum of Negative Ranks</strong>: <span class="math inline">\(\left|-2\right| = 2\)</span></p>
</div>
<h6 id="step-5-1">Step 5</h6>
<p>The <span class="math inline">\(p\)</span>-value of the test is then obtained by computing the probabilities of all possible sums using mathematical counting techniques. This is a very tedious process that only a mathematician would enjoy pursuing. However, the end result is fairly easily understood. If you are interested, read the details.</p>
<div style="padding-left:30px; padding-right:15px;">
<p><strong>Details</strong></p>
<p>When there are <span class="math inline">\(n=5\)</span> ranks, the possible sums of ranks range from 0 to 15 and hit every integer in between, i.e., <span class="math inline">\(1, 2, 3, \ldots, 15\)</span>. (Note, if summing the negative ranks these sums would technically all be negative.)</p>
<p>To verify that <span class="math inline">\(15\)</span> is the largest sum possible for <span class="math inline">\(n=5\)</span> ranks, note that:</p>
<ul>
<li><p><span class="math inline">\(1+5 = 6\)</span>,</p></li>
<li><p><span class="math inline">\(2 + 4 = 6\)</span>,</p></li>
<li><p>and finally <span class="math inline">\(3 = \frac{6}{2}\)</span>.</p></li>
</ul>
<p>Thus, there are 2 sums of 6 and one sum of <span class="math inline">\(\frac{6}{2}\)</span>. This could be said in a mathematically equivalent way by stating there are <span class="math inline">\(\frac{4}{2}\)</span> sums of 6 and one sum of <span class="math inline">\(\frac{6}{2}\)</span>. By multiplication this gives <span class="math display">\[
  \frac{4}{2}\cdot\frac{6}{1} + \frac{1}{1}\cdot\frac{6}{2} = \frac{4\cdot6 + 1\cdot6}{2} = \frac{5\cdot6}{2} = \frac{n(n+1)}{2} = 15
\]</span></p>
<p>The probability of each sum occurring is computed by counting all of the ways a certain sum can occur (combinations) and dividing by the total number of sums possible. (There are 32 total different groups of ranks possible when there are <span class="math inline">\(n=5\)</span> ranks.)</p>
<p>For example, a sum of 1 can happen only one way, only the rank of 1 is in the group. A sum of 2 can also only happen 1 way. The sum of 3 however, can happen two ways: we could have the ranks of 1 and 2 in the group, or just the rank of 3 in the group. A similar counting technique is then implemented for each possible sum. After all the calculations are performed, the distribution of possible sums looks like what is shown in the following plot, where the red bars show those sums that are as extreme or more extreme than a sum of <span class="math inline">\(2\)</span> (or its opposite of <span class="math inline">\(15-2=13\)</span>).</p>
<p><img src="WilcoxonTests_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Computing the probabilities of all possible sums creates a distribution of the test statistic (shown in the plot above). Note that the test statistic is obtained in Step 4 (above) by taking the sum of the ranks. Once the distribution of the test statistic is established, the <span class="math inline">\(p\)</span>-value of the test can be calculated as the combined probability of possible sums that are as extreme or more extreme than the one observed.</p>
</div>
<p>For this example, it turns out that the probability of getting a sum of negative ranks as extreme or more extreme than <span class="math inline">\(-2\)</span> is <span class="math inline">\(p=0.1875\)</span> (the sum of the probabilities of the red bars in the plot above). Thus, at the <span class="math inline">\(\alpha=0.05\)</span> level we would fail to reject the null hypothesis that the center of the distribution of differences is zero. We will continue to assume the null hypothesis was true, that the median off-track hourly wage of BYU-Idaho students is the same as the Idaho minimum wage.</p>
<h6 id="final-comment">Final Comment</h6>
<p>Notice that when the sample size is large the distribution of the test statistic can be approximated by a normal distribution. Most software applications use this approximation when the sample size is over <span class="math inline">\(50\)</span>, i.e., for <span class="math inline">\(n\geq50\)</span> because computing all the possible sums of ranks becomes incredibly time consuming. Thus, for large sample sizes the results will be almost identical whether the Wilcoxon Tests or a t Test is used.</p>
</div>
</div>
<hr />
</div>
</div>
<div id="wilcoxon-rank-sum-mann-whitney-test" class="section level3 tabset tabset-fade tabset-pills">
<h3>Wilcoxon Rank Sum (Mann-Whitney) Test</h3>
<div style="float:left;width:125px;" align="center">
<p><img src="Images/QuantYQualXg2.png" width=58px;></p>
</div>
<p>For testing the equality of the medians of two (possibly different) distributions of a quantitative variable.</p>
<div id="overview-1" class="section level4">
<h4>Overview</h4>
<div style="padding-left:125px;">
<p>The nonparametric equivalent of the Independent Samples t Test. Can also be used when data is ordered (ordinal) but does not have an exact measurement. For example, first place, second place, and so on.</p>
<p>The Independent Samples t Test is more appropriate when the distributions are normal, or when the sample size for each sample is large.</p>
<p>The test is negatively affected when there are ties (repeated values) present in the data, but the results are still useful if there are relatively few ties.</p>
<p><strong>Hypotheses</strong></p>
<p>Originally designed to test for the equality of medians from two identically shaped distributions.</p>
<div style="padding-left:15px;">
<p><span class="math inline">\(H_0: \text{difference in medians} = 0\)</span></p>
<p><span class="math inline">\(H_a: \text{difference in medians} \neq 0\)</span></p>
</div>
<p>However, the test also allows for the more general hypotheses that one distribution is <em>stochastically greater</em> than the other.</p>
<div style="padding-left:15px;">
<p><span class="math inline">\(H_0: \text{the distributions are stochastically equal}\)</span></p>
<p><span class="math inline">\(H_a: \text{one distribution is stochastically greater than the other}\)</span></p>
</div>
<p>If these hypotheses are used, then the distributions do not have to be identically distributed.</p>
<p>(Note: Men’s heights are <em>stochastically greater</em> than women’s heights because men are generally taller than women, but not all men are taller than all women.)</p>
<p><strong>Examples</strong>: <a href="./Analyses/BugSprayWilcoxonRankSum.html">BugSpray</a>, <a href="./Analyses/MoralIntegration.html">MoralIntegration</a></p>
</div>
<hr />
</div>
<div id="r-intstructions" class="section level4">
<h4>R Intstructions</h4>
<div style="padding-left:125px;">
<p><strong>Console</strong> Help Command: <code>?wilcox.test()</code></p>
<p>There are two ways to perform the test.</p>
<p>Option 1:</p>
<p><code>wilcox.test(object1, object2, mu = YourNull, alternative = YourAlternative, conf.level = 0.95)</code></p>
<ul>
<li><code>object1</code> must be a “numeric” vector that represents the first sample of data.</li>
<li><code>obejct2</code> must be a “numeric” vector that represents the second sample of data.</li>
<li><code>YourNull</code> is the numeric value from your null hypothesis for the difference in medians from the two groups.</li>
<li><code>YourAlternative</code> is one of the three options: <code>&quot;two.sided&quot;</code>, <code>&quot;greater&quot;</code>, <code>&quot;less&quot;</code> and should correspond to your alternative hypothesis.</li>
<li>The value for <code>conf.level = 0.95</code> can be changed to any desired confidence level, like 0.90 or 0.99. It should correspond to <span class="math inline">\(1-\alpha\)</span>.</li>
</ul>
<p>Option 2:</p>
<p><code>wilcox.test(column ~ group, data = YourData, mu = YourNull, alternative = YourAlternative, conf.level = 0.95)</code></p>
<ul>
<li><code>column</code> must be a “numeric” vector from <code>YourData</code> that represents the data for both samples.</li>
<li><code>group</code> must be a “factor” or “character” vector from <code>YourData</code> that represents the group assignment for each observation. There can only be two groups specified in this column of data.</li>
<li><code>YourNull</code> is the numeric value from your null hypothesis for the difference in medians from the two groups.</li>
<li><code>YourAlternative</code> is one of the three options: <code>&quot;two.sided&quot;</code>, <code>&quot;greater&quot;</code>, <code>&quot;less&quot;</code> and should correspond to your alternative hypothesis.</li>
<li>The value for <code>conf.level = 0.95</code> can be changed to any desired confidence level, like 0.90 or 0.99. It should correspond to <span class="math inline">\(1-\alpha\)</span>.</li>
</ul>
</div>
<hr />
</div>
<div id="explanation-1" class="section level4">
<h4>Explanation</h4>
<div style="padding-left:125px;">


<p>In many cases it is of interest to perform a hypothesis test concerning the equality of the centers of two (possibly different) distributions. In other words, an independent samples test. The Wilcoxon Rank Sum Test allows a nonparametric approach to doing this. It is often considered the nonparametric equivalent of the independent samples t test.</p>
<p>The method is most easily explained through an example. The theory behind it is very similar to the theory behind the Wilcoxon Signed-Rank Test.</p>
<p><br /></p>
<div id="independent-samples-data-example" class="section level5">
<h5>Independent Samples Data Example</h5>
<div style="padding-left:15px;">

<div style="color:#a8a8a8;">
<p>Note: the data for this example comes from the original 1945 paper <a href="http://sci2s.ugr.es/keel/pdf/algorithm/articulo/wilcoxon1945.pdf">Individual Comparison by Ranking Methods</a> by Frank Wilcoxon.</p>
</div>
<div id="background-2" class="section level6">
<h6>Background</h6>
<p>The percent of flies (bugs) killed from two different concentrations of a certain spray were recorded from 16 different trials, 8 trials per treatment concentration. The experiment hypothesized that the center of the distributions of the percent killed by either concentration were the same. In other words, that both treatments were equally effective. The alternative hypothesis was that the treatments differed in their effectiveness.</p>
<div style="padding-left:15px;">
<table>
<thead>
<tr class="header">
<th>Spray Concentration</th>
<th>Percent Killed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>68, 68, 59, 72, 64, 67, 70, 74</td>
</tr>
<tr class="even">
<td>B</td>
<td>60, 67, 61, 62, 67, 63, 56, 58</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="step-1-2" class="section level6">
<h6>Step 1</h6>
<p>The first step of the Wilcoxon Rank Sum Test is to order all the data from smallest <em>magnitude</em> to largest <em>magnitude</em>, while keeping track of the group.</p>
<div style="padding-left:15px;">
<table>
<thead>
<tr class="header">
<th>Sorted Data</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Percent Killed</td>
<td>56</td>
<td>58</td>
<td>59</td>
<td>60</td>
<td>61</td>
<td>62</td>
<td>63</td>
<td>64</td>
<td>67</td>
<td>67</td>
<td>67</td>
<td>68</td>
<td>68</td>
<td>70</td>
<td>72</td>
<td>74</td>
</tr>
<tr class="even">
<td>Concentration</td>
<td>B</td>
<td>B</td>
<td>A</td>
<td>B</td>
<td>B</td>
<td>B</td>
<td>B</td>
<td>A</td>
<td>A</td>
<td>B</td>
<td>B</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="step-2-2" class="section level6">
<h6>Step 2</h6>
<p>The next step is to rank the ordered values.</p>
<div style="padding-left:15px;">
<table>
<thead>
<tr class="header">
<th>Sorted Data</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Percent Killed</td>
<td>56</td>
<td>58</td>
<td>59</td>
<td>60</td>
<td>61</td>
<td>62</td>
<td>63</td>
<td>64</td>
<td>67</td>
<td>67</td>
<td>67</td>
<td>68</td>
<td>68</td>
<td>70</td>
<td>72</td>
<td>74</td>
</tr>
<tr class="even">
<td>Concentration</td>
<td>B</td>
<td>B</td>
<td>A</td>
<td>B</td>
<td>B</td>
<td>B</td>
<td>B</td>
<td>A</td>
<td>A</td>
<td>B</td>
<td>B</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
</tr>
<tr class="odd">
<td>Rank</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>11</td>
<td>12</td>
<td>13</td>
<td>14</td>
<td>15</td>
<td>16</td>
</tr>
</tbody>
</table>
</div>
<p>Note that the ranks will always be of the form <span class="math inline">\(1, 2, \ldots, n\)</span>. In this case, <span class="math inline">\(n=16\)</span>.</p>
<p>Any ranks that are tied need to have the average rank assigned to each of those that are tied.</p>
<table>
<thead>
<tr class="header">
<th>Sorted Data</th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Percent Killed</td>
<td>56</td>
<td>58</td>
<td>59</td>
<td>60</td>
<td>61</td>
<td>62</td>
<td>63</td>
<td>64</td>
<td><span style="color:#B22222;">67</span></td>
<td><span style="color:#B22222;">67</span></td>
<td><span style="color:#B22222;">67</span></td>
<td><span style="color:#7EC0EE;">68</span></td>
<td><span style="color:#7EC0EE;">68</span></td>
<td>70</td>
<td>72</td>
<td>74</td>
</tr>
<tr class="even">
<td>Concentration</td>
<td>B</td>
<td>B</td>
<td>A</td>
<td>B</td>
<td>B</td>
<td>B</td>
<td>B</td>
<td>A</td>
<td>A</td>
<td>B</td>
<td>B</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
<td>A</td>
</tr>
<tr class="odd">
<td>Rank</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td><span style="color:#B22222;">10</span></td>
<td><span style="color:#B22222;">10</span></td>
<td><span style="color:#B22222;">10</span></td>
<td><span style="color:#7EC0EE;">12.5</span></td>
<td><span style="color:#7EC0EE;">12.5</span></td>
<td>14</td>
<td>15</td>
<td>16</td>
</tr>
</tbody>
</table>
</div>
<div id="step-3-2" class="section level6">
<h6>Step 3</h6>
<p>The ranks are then returned to their original groups.</p>
<table>
<thead>
<tr class="header">
<th>Ranks of Spray A</th>
<th>Ranks of Spray B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>3, 8, 10, 12.5, 12.5, 14, 15, 16</td>
<td>1, 2, 4, 5, 6, 7, 10, 10</td>
</tr>
</tbody>
</table>
</div>
<div id="step-4-2" class="section level6">
<h6>Step 4</h6>
<p>The ranks are summed for one of the groups. (It does not matter which group.)</p>
<div style="padding-left:15px;">
<p><strong>Sum of Ranks for Spray A</strong>: <span class="math display">\[
 3+8+10+12.5+12.5+14+15+16 = 91
\]</span></p>
</div>
</div>
<div id="step-5-2" class="section level6">
<h6>Step 5</h6>
<p>The <span class="math inline">\(p\)</span>-value of the test is then obtained by computing the probabilities of all possible sums that one group can achieve using mathematical counting techniques. This is a very tedious process that only a mathematician would enjoy pursuing. However, the end result is fairly easily understood. If you are interested, read the details.</p>
<div style="padding-left:30px; padding-right:15px;">

<hr />
<p><strong>Details</strong></p>
<p>When there are <span class="math inline">\(n=16\)</span> ranks, with just <span class="math inline">\(8\)</span> of the ranks assigned to one group, the possible sums of ranks range from <span class="math inline">\(36\)</span> to <span class="math inline">\(100\)</span> and include every integer in between, i.e., <span class="math inline">\(36, 37, 38, \ldots, 100\)</span>.</p>
<p>Note that the smallest sum would be obtained if the ranks 1-8 were in the group. The largest sum would be obtained if the ranks 9-16 were in the group.</p>
<p>The probability of each possible sum occurring is computed by counting all of the ways a certain sum can occur (combinations) and dividing by the total number of sums possible. (There are 12,870 total different sets of ranks possible when there are <span class="math inline">\(n=16\)</span> ranks and <span class="math inline">\(8\)</span> are assigned to one group.)</p>
<p>The distribution of possible sums looks like what is shown in the following plot, where the red bars show those sums that are as extreme or more extreme than a sum of <span class="math inline">\(91\)</span> (or its opposite of <span class="math inline">\(136-91=45\)</span>).</p>
<p><img src="WilcoxonTests_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Computing the probabilities of all possible sums creates a distribution of the test statistic (shown in the plot above). Note that the test statistic is obtained in Step 4 (above) by taking the sum of the ranks. Once the distribution of the test statistic is established, the <span class="math inline">\(p\)</span>-value of the test can be calculated as the combined probability of possible sums that are as extreme or more extreme than the one observed.</p>
<hr />
</div>
<p>For this example, it turns out that the probability of getting a sum of negative ranks as extreme or more extreme than <span class="math inline">\(91\)</span> is <span class="math inline">\(p=0.01476\)</span> (the sum of the probabilities of the red bars in the plot above). Thus, at the <span class="math inline">\(\alpha=0.05\)</span> level we would reject the null hypothesis that the difference in the center of the distributions is zero. We conclude that the Spray Concentration A is more effective at killing flies (bugs).</p>
</div>
<div id="comment-1" class="section level6">
<h6>Comment</h6>
<p>The hypotheses for the Wilcoxon Rank Sum Test are difficult to write out in simple mathematical statements. The test is often referred to as a test of medians, but goes deeper than this. Technically, it allows us to determine if one distribution is stochastically larger than another. In other words, if one distribution typically gives larger values than does another distribution. If the distributions are identically shaped and have the same spread, then this implies the medians (and means) are different.</p>
<p>Thus, the hypotheses for the test can be written mathematically as <span class="math display">\[
  H_0: \text{difference in medians} = 0
\]</span> <span class="math display">\[
  H_a: \text{difference in medians} \neq 0
\]</span> or even as <span class="math display">\[
  H_0: \mu_1-\mu_2 = 0
\]</span> <span class="math display">\[
  H_a: \mu_1-\mu_2 \neq 0
\]</span></p>
<p>However, it is important to remember that the estimated difference in location parameters that results from the test does not provide a measurement on either of these things. However, the <span class="math inline">\(p\)</span>-value can lead us to determine whether to reject, or fail to reject the null, whichever of the above hypotheses is used.</p>
<p>As stated in the R help file for this test <code>?wilcox.test()</code> “the estimator for the difference in location parameters does not estimate the difference in medians (a common misconception) but rather the median of the difference between a sample from [the first population] and a sample from [the second population].” These are technical details that most people ignore without encountering too much difficulty. However, it does remind us that the t test is more easily interpreted whenever it is appropriate to use that test.</p>
</div>
<p><br /></p>
</div>
</div>
<div id="final-comment-1" class="section level5">
<h5>Final Comment</h5>
<p>Notice that when the sample size is large the distribution of the test statistic can be approximated by a normal distribution. Most software applications use this approximation when the sample size is over <span class="math inline">\(50\)</span>, i.e., for <span class="math inline">\(n\geq50\)</span> because computing all the possible sums of ranks becomes incredibly time consuming. Thus, for large sample sizes the results will be almost identical whether the Wilcoxon Tests or a t Test is used.</p>
</div>
<hr />
<footer>
</footer>
</div>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
